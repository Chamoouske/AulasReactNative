{"ast":null,"code":"'use strict';\n\ndescribe('resolveAssetSource', function () {\n  var AssetRegistry;\n  var resolveAssetSource;\n  var NativeSourceCode;\n  var Platform;\n  beforeEach(function () {\n    jest.resetModules();\n    AssetRegistry = require(\"../AssetRegistry\");\n    resolveAssetSource = require(\"../resolveAssetSource\");\n    NativeSourceCode = require(\"../../NativeModules/specs/NativeSourceCode\").default;\n    Platform = require(\"../../Utilities/Platform\");\n  });\n  it('returns same source for simple static and network images', function () {\n    var source1 = {\n      uri: 'https://www.facebook.com/logo'\n    };\n    expect(resolveAssetSource(source1)).toBe(source1);\n    var source2 = {\n      uri: 'logo'\n    };\n    expect(resolveAssetSource(source2)).toBe(source2);\n  });\n  it('does not change deprecated assets', function () {\n    expect(resolveAssetSource({\n      deprecated: true,\n      width: 100,\n      height: 200,\n      uri: 'logo'\n    })).toEqual({\n      deprecated: true,\n      width: 100,\n      height: 200,\n      uri: 'logo'\n    });\n  });\n  it('ignores any weird data', function () {\n    expect(resolveAssetSource(null)).toBe(null);\n    expect(resolveAssetSource(42)).toBe(null);\n    expect(resolveAssetSource('nonsense')).toBe(null);\n  });\n  describe('bundle was loaded from network (DEV)', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: 'http://10.0.0.1:8081/main.bundle'\n        };\n      };\n\n      Platform.OS = 'ios';\n    });\n    it('uses network image', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/module/a',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: 'logo',\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'http://10.0.0.1:8081/assets/module/a/logo.png?platform=ios&hash=5b6f00f',\n        scale: 1\n      });\n    });\n    it('picks matching scale', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/module/a',\n        width: 100,\n        height: 200,\n        scales: [1, 2, 3],\n        hash: '5b6f00f',\n        name: 'logo',\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'http://10.0.0.1:8081/assets/module/a/logo@2x.png?platform=ios&hash=5b6f00f',\n        scale: 2\n      });\n    });\n  });\n  describe('bundle was loaded from file on iOS', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: 'file:///Path/To/Sample.app/main.bundle'\n        };\n      };\n\n      Platform.OS = 'ios';\n    });\n    it('uses pre-packed image', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/module/a',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: 'logo',\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'file:///Path/To/Sample.app/assets/module/a/logo.png',\n        scale: 1\n      });\n    });\n    it('resolves an image with a relative path outside of root', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/module/a',\n        httpServerLocation: '/assets/../../module/a',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: 'logo',\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'file:///Path/To/Sample.app/assets/__module/a/logo.png',\n        scale: 1\n      });\n    });\n  });\n  describe('bundle was loaded from assets on Android', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: 'assets://Path/To/Simulator/main.bundle'\n        };\n      };\n\n      Platform.OS = 'android';\n    });\n    it('uses pre-packed image', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/AwesomeModule/Subdir',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: \"!@Logo#1_\\u20AC\",\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'awesomemodule_subdir_logo1_',\n        scale: 1\n      });\n    });\n    it('resolves an image with a relative path outside of root', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/module/a',\n        httpServerLocation: '/assets/../../module/a',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: 'logo',\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: '__module_a_logo',\n        scale: 1\n      });\n    });\n  });\n  describe('bundle was loaded from file on Android', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: 'file:///sdcard/Path/To/Simulator/main.bundle'\n        };\n      };\n\n      Platform.OS = 'android';\n    });\n    it('uses pre-packed image', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/AwesomeModule/Subdir',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: \"!@Logo#1_\\u20AC\",\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'file:///sdcard/Path/To/Simulator/drawable-mdpi/awesomemodule_subdir_logo1_.png',\n        scale: 1\n      });\n    });\n  });\n  describe('bundle was loaded from raw file on Android', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: '/sdcard/Path/To/Simulator/main.bundle'\n        };\n      };\n\n      Platform.OS = 'android';\n    });\n    it('uses sideloaded image', function () {\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/AwesomeModule/Subdir',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: \"!@Logo#1_\\u20AC\",\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'file:///sdcard/Path/To/Simulator/drawable-mdpi/awesomemodule_subdir_logo1_.png',\n        scale: 1\n      });\n    });\n  });\n  describe('source resolver can be customized', function () {\n    beforeEach(function () {\n      NativeSourceCode.getConstants = function () {\n        return {\n          scriptURL: 'file:///sdcard/Path/To/Simulator/main.bundle'\n        };\n      };\n\n      Platform.OS = 'android';\n    });\n    it('uses bundled source, event when js is sideloaded', function () {\n      resolveAssetSource.setCustomSourceTransformer(function (resolver) {\n        return resolver.resourceIdentifierWithoutScale();\n      });\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/AwesomeModule/Subdir',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: \"!@Logo#1_\\u20AC\",\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'awesomemodule_subdir_logo1_',\n        scale: 1\n      });\n    });\n    it('allows any customization', function () {\n      resolveAssetSource.setCustomSourceTransformer(function (resolver) {\n        return resolver.fromSource('TEST');\n      });\n      expectResolvesAsset({\n        __packager_asset: true,\n        fileSystemLocation: '/root/app/module/a',\n        httpServerLocation: '/assets/AwesomeModule/Subdir',\n        width: 100,\n        height: 200,\n        scales: [1],\n        hash: '5b6f00f',\n        name: \"!@Logo#1_\\u20AC\",\n        type: 'png'\n      }, {\n        __packager_asset: true,\n        width: 100,\n        height: 200,\n        uri: 'TEST',\n        scale: 1\n      });\n    });\n  });\n\n  function expectResolvesAsset(input, expectedSource) {\n    var assetId = AssetRegistry.registerAsset(input);\n    expect(resolveAssetSource(assetId)).toEqual(expectedSource);\n  }\n});\ndescribe('resolveAssetSource.pickScale', function () {\n  var resolveAssetSource = require(\"../resolveAssetSource\");\n\n  it('picks matching scale', function () {\n    expect(resolveAssetSource.pickScale([1], 2)).toBe(1);\n    expect(resolveAssetSource.pickScale([1, 2, 3], 2)).toBe(2);\n    expect(resolveAssetSource.pickScale([1, 2], 3)).toBe(2);\n    expect(resolveAssetSource.pickScale([1, 2, 3, 4], 3.5)).toBe(4);\n    expect(resolveAssetSource.pickScale([3, 4], 2)).toBe(3);\n    expect(resolveAssetSource.pickScale([], 2)).toBe(1);\n  });\n});","map":{"version":3,"sources":["/home/chamoouske/Aulas/ReactNative/RandomWord/node_modules/react-native/Libraries/Image/__tests__/resolveAssetSource-test.js"],"names":["describe","AssetRegistry","resolveAssetSource","NativeSourceCode","Platform","beforeEach","jest","resetModules","require","default","it","source1","uri","expect","toBe","source2","deprecated","width","height","toEqual","getConstants","scriptURL","OS","expectResolvesAsset","__packager_asset","fileSystemLocation","httpServerLocation","scales","hash","name","type","scale","setCustomSourceTransformer","resolver","resourceIdentifierWithoutScale","fromSource","input","expectedSource","assetId","registerAsset","pickScale"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @emails oncall+react_native\n */\n\n'use strict';\n\ndescribe('resolveAssetSource', () => {\n  let AssetRegistry;\n  let resolveAssetSource;\n  let NativeSourceCode;\n  let Platform;\n\n  beforeEach(() => {\n    jest.resetModules();\n\n    AssetRegistry = require('../AssetRegistry');\n    resolveAssetSource = require('../resolveAssetSource');\n    NativeSourceCode = require('../../NativeModules/specs/NativeSourceCode')\n      .default;\n    Platform = require('../../Utilities/Platform');\n  });\n\n  it('returns same source for simple static and network images', () => {\n    const source1 = {uri: 'https://www.facebook.com/logo'};\n    expect(resolveAssetSource(source1)).toBe(source1);\n\n    const source2 = {uri: 'logo'};\n    expect(resolveAssetSource(source2)).toBe(source2);\n  });\n\n  it('does not change deprecated assets', () => {\n    expect(\n      resolveAssetSource({\n        deprecated: true,\n        width: 100,\n        height: 200,\n        uri: 'logo',\n      }),\n    ).toEqual({\n      deprecated: true,\n      width: 100,\n      height: 200,\n      uri: 'logo',\n    });\n  });\n\n  it('ignores any weird data', () => {\n    expect(resolveAssetSource(null)).toBe(null);\n    expect(resolveAssetSource(42)).toBe(null);\n    expect(resolveAssetSource('nonsense')).toBe(null);\n  });\n\n  describe('bundle was loaded from network (DEV)', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: 'http://10.0.0.1:8081/main.bundle',\n      });\n      Platform.OS = 'ios';\n    });\n\n    it('uses network image', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/module/a',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: 'logo',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri:\n            'http://10.0.0.1:8081/assets/module/a/logo.png?platform=ios&hash=5b6f00f',\n          scale: 1,\n        },\n      );\n    });\n\n    it('picks matching scale', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/module/a',\n          width: 100,\n          height: 200,\n          scales: [1, 2, 3],\n          hash: '5b6f00f',\n          name: 'logo',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri:\n            'http://10.0.0.1:8081/assets/module/a/logo@2x.png?platform=ios&hash=5b6f00f',\n          scale: 2,\n        },\n      );\n    });\n  });\n\n  describe('bundle was loaded from file on iOS', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: 'file:///Path/To/Sample.app/main.bundle',\n      });\n      Platform.OS = 'ios';\n    });\n\n    it('uses pre-packed image', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/module/a',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: 'logo',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: 'file:///Path/To/Sample.app/assets/module/a/logo.png',\n          scale: 1,\n        },\n      );\n    });\n\n    it('resolves an image with a relative path outside of root', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/module/a',\n          httpServerLocation: '/assets/../../module/a',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: 'logo',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: 'file:///Path/To/Sample.app/assets/__module/a/logo.png',\n          scale: 1,\n        },\n      );\n    });\n  });\n\n  describe('bundle was loaded from assets on Android', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: 'assets://Path/To/Simulator/main.bundle',\n      });\n      Platform.OS = 'android';\n    });\n\n    it('uses pre-packed image', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/AwesomeModule/Subdir',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: '!@Logo#1_\\u20ac', // Invalid chars shouldn't get passed to native\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: 'awesomemodule_subdir_logo1_',\n          scale: 1,\n        },\n      );\n    });\n\n    it('resolves an image with a relative path outside of root', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/module/a',\n          httpServerLocation: '/assets/../../module/a',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: 'logo',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: '__module_a_logo',\n          scale: 1,\n        },\n      );\n    });\n  });\n\n  describe('bundle was loaded from file on Android', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: 'file:///sdcard/Path/To/Simulator/main.bundle',\n      });\n      Platform.OS = 'android';\n    });\n\n    it('uses pre-packed image', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/AwesomeModule/Subdir',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: '!@Logo#1_\\u20ac',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri:\n            'file:///sdcard/Path/To/Simulator/drawable-mdpi/awesomemodule_subdir_logo1_.png',\n          scale: 1,\n        },\n      );\n    });\n  });\n\n  describe('bundle was loaded from raw file on Android', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: '/sdcard/Path/To/Simulator/main.bundle',\n      });\n      Platform.OS = 'android';\n    });\n\n    it('uses sideloaded image', () => {\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/AwesomeModule/Subdir',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: '!@Logo#1_\\u20ac',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri:\n            'file:///sdcard/Path/To/Simulator/drawable-mdpi/awesomemodule_subdir_logo1_.png',\n          scale: 1,\n        },\n      );\n    });\n  });\n\n  describe('source resolver can be customized', () => {\n    beforeEach(() => {\n      NativeSourceCode.getConstants = () => ({\n        scriptURL: 'file:///sdcard/Path/To/Simulator/main.bundle',\n      });\n      Platform.OS = 'android';\n    });\n\n    it('uses bundled source, event when js is sideloaded', () => {\n      resolveAssetSource.setCustomSourceTransformer(resolver =>\n        resolver.resourceIdentifierWithoutScale(),\n      );\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/AwesomeModule/Subdir',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: '!@Logo#1_\\u20ac',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: 'awesomemodule_subdir_logo1_',\n          scale: 1,\n        },\n      );\n    });\n\n    it('allows any customization', () => {\n      resolveAssetSource.setCustomSourceTransformer(resolver =>\n        resolver.fromSource('TEST'),\n      );\n      expectResolvesAsset(\n        {\n          __packager_asset: true,\n          fileSystemLocation: '/root/app/module/a',\n          httpServerLocation: '/assets/AwesomeModule/Subdir',\n          width: 100,\n          height: 200,\n          scales: [1],\n          hash: '5b6f00f',\n          name: '!@Logo#1_\\u20ac',\n          type: 'png',\n        },\n        {\n          __packager_asset: true,\n          width: 100,\n          height: 200,\n          uri: 'TEST',\n          scale: 1,\n        },\n      );\n    });\n  });\n\n  function expectResolvesAsset(input, expectedSource) {\n    const assetId = AssetRegistry.registerAsset(input);\n    expect(resolveAssetSource(assetId)).toEqual(expectedSource);\n  }\n});\n\ndescribe('resolveAssetSource.pickScale', () => {\n  const resolveAssetSource = require('../resolveAssetSource');\n\n  it('picks matching scale', () => {\n    expect(resolveAssetSource.pickScale([1], 2)).toBe(1);\n    expect(resolveAssetSource.pickScale([1, 2, 3], 2)).toBe(2);\n    expect(resolveAssetSource.pickScale([1, 2], 3)).toBe(2);\n    expect(resolveAssetSource.pickScale([1, 2, 3, 4], 3.5)).toBe(4);\n    expect(resolveAssetSource.pickScale([3, 4], 2)).toBe(3);\n    expect(resolveAssetSource.pickScale([], 2)).toBe(1);\n  });\n});\n"]},"metadata":{},"sourceType":"script"}