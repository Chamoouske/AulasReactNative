{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar fs_extra_1 = __importDefault(require(\"fs-extra\"));\n\nvar Xcodeproj_1 = require(\"./utils/Xcodeproj\");\n\nfunction setProvisioningProfileForPbxproj(projectRoot, _ref) {\n  var targetName = _ref.targetName,\n      profileName = _ref.profileName,\n      appleTeamId = _ref.appleTeamId;\n  var project = Xcodeproj_1.getPbxproj(projectRoot);\n\n  var _ref2 = targetName ? Xcodeproj_1.findNativeTargetByName(project, targetName) : Xcodeproj_1.findFirstNativeTarget(project),\n      _ref3 = _slicedToArray(_ref2, 2),\n      nativeTargetId = _ref3[0],\n      nativeTarget = _ref3[1];\n\n  Xcodeproj_1.getBuildConfigurationForId(project, nativeTarget.buildConfigurationList).filter(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        item = _ref5[1];\n\n    return item.buildSettings.PRODUCT_NAME;\n  }).forEach(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        item = _ref7[1];\n\n    item.buildSettings.PROVISIONING_PROFILE_SPECIFIER = \"\\\"\" + profileName + \"\\\"\";\n    item.buildSettings.DEVELOPMENT_TEAM = appleTeamId;\n    item.buildSettings.CODE_SIGN_IDENTITY = '\"iPhone Distribution\"';\n    item.buildSettings.CODE_SIGN_STYLE = 'Manual';\n  });\n  Object.entries(Xcodeproj_1.getProjectSection(project)).filter(Xcodeproj_1.isNotComment).forEach(function (_ref8) {\n    var _ref9 = _slicedToArray(_ref8, 2),\n        item = _ref9[1];\n\n    item.attributes.TargetAttributes[nativeTargetId].DevelopmentTeam = appleTeamId;\n    item.attributes.TargetAttributes[nativeTargetId].ProvisioningStyle = 'Manual';\n  });\n  fs_extra_1.default.writeFileSync(project.filepath, project.writeSync());\n}\n\nexports.setProvisioningProfileForPbxproj = setProvisioningProfileForPbxproj;","map":{"version":3,"sources":["../../src/ios/ProvisioningProfile.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,IAAA,UAAA,GAAA,eAAA,CAAA,OAAA,CAAA,UAAA,CAAA,CAAA;;AAEA,IAAA,WAAA,GAAA,OAAA,qBAAA;;AAiBA,SAAS,gCAAT,CACE,WADF,QAEuE;AAAA,MAAnE,UAAmE,QAAnE,UAAmE;AAAA,MAAvD,WAAuD,QAAvD,WAAuD;AAAA,MAA1C,WAA0C,QAA1C,WAA0C;AAErE,MAAM,OAAO,GAAG,WAAA,CAAA,UAAA,CAAW,WAAX,CAAhB;;AAFqE,cAG9B,UAAU,GAC7C,WAAA,CAAA,sBAAA,CAAuB,OAAvB,EAAgC,UAAhC,CAD6C,GAE7C,WAAA,CAAA,qBAAA,CAAsB,OAAtB,CALiE;AAAA;AAAA,MAG9D,cAH8D;AAAA,MAG9C,YAH8C;;AAOrE,EAAA,WAAA,CAAA,0BAAA,CAA2B,OAA3B,EAAoC,YAAY,CAAC,sBAAjD,EACG,MADH,CACU;AAAA;AAAA,QAAI,IAAJ;;AAAA,WAAyC,IAAI,CAAC,aAAL,CAAmB,YAA5D;AAAA,GADV,EAEG,OAFH,CAEW,iBAAwC;AAAA;AAAA,QAApC,IAAoC;;AAC/C,IAAA,IAAI,CAAC,aAAL,CAAmB,8BAAnB,UAAwD,WAAxD;AACA,IAAA,IAAI,CAAC,aAAL,CAAmB,gBAAnB,GAAsC,WAAtC;AACA,IAAA,IAAI,CAAC,aAAL,CAAmB,kBAAnB,GAAwC,uBAAxC;AACA,IAAA,IAAI,CAAC,aAAL,CAAmB,eAAnB,GAAqC,QAArC;AACD,GAPH;AASA,EAAA,MAAM,CAAC,OAAP,CAAe,WAAA,CAAA,iBAAA,CAAkB,OAAlB,CAAf,EACG,MADH,CACU,WAAA,CAAA,YADV,EAEG,OAFH,CAEW,iBAAkC;AAAA;AAAA,QAA9B,IAA8B;;AACzC,IAAA,IAAI,CAAC,UAAL,CAAgB,gBAAhB,CAAiC,cAAjC,EAAiD,eAAjD,GAAmE,WAAnE;AACA,IAAA,IAAI,CAAC,UAAL,CAAgB,gBAAhB,CAAiC,cAAjC,EAAiD,iBAAjD,GAAqE,QAArE;AACD,GALH;AAOA,EAAA,UAAA,CAAA,OAAA,CAAG,aAAH,CAAiB,OAAO,CAAC,QAAzB,EAAmC,OAAO,CAAC,SAAR,EAAnC;AACD;;AAEQ,OAAA,CAAA,gCAAA,GAAA,gCAAA","sourcesContent":["import fs from 'fs-extra';\n\nimport {\n  ConfigurationSectionEntry,\n  findFirstNativeTarget,\n  findNativeTargetByName,\n  getBuildConfigurationForId,\n  getPbxproj,\n  getProjectSection,\n  isNotComment,\n  ProjectSectionEntry,\n} from './utils/Xcodeproj';\n\ntype ProvisioningProfileSettings = {\n  targetName?: string;\n  appleTeamId: string;\n  profileName: string;\n};\n\nfunction setProvisioningProfileForPbxproj(\n  projectRoot: string,\n  { targetName, profileName, appleTeamId }: ProvisioningProfileSettings\n): void {\n  const project = getPbxproj(projectRoot);\n  const [nativeTargetId, nativeTarget] = targetName\n    ? findNativeTargetByName(project, targetName)\n    : findFirstNativeTarget(project);\n\n  getBuildConfigurationForId(project, nativeTarget.buildConfigurationList)\n    .filter(([, item]: ConfigurationSectionEntry) => item.buildSettings.PRODUCT_NAME)\n    .forEach(([, item]: ConfigurationSectionEntry) => {\n      item.buildSettings.PROVISIONING_PROFILE_SPECIFIER = `\"${profileName}\"`;\n      item.buildSettings.DEVELOPMENT_TEAM = appleTeamId;\n      item.buildSettings.CODE_SIGN_IDENTITY = '\"iPhone Distribution\"';\n      item.buildSettings.CODE_SIGN_STYLE = 'Manual';\n    });\n\n  Object.entries(getProjectSection(project))\n    .filter(isNotComment)\n    .forEach(([, item]: ProjectSectionEntry) => {\n      item.attributes.TargetAttributes[nativeTargetId].DevelopmentTeam = appleTeamId;\n      item.attributes.TargetAttributes[nativeTargetId].ProvisioningStyle = 'Manual';\n    });\n\n  fs.writeFileSync(project.filepath, project.writeSync());\n}\n\nexport { setProvisioningProfileForPbxproj };\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}